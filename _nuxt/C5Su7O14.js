var I=Object.defineProperty;var N=(a,e,s)=>e in a?I(a,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[e]=s;var o=(a,e,s)=>N(a,typeof e!="symbol"?e+"":e,s);import{a as k,a2 as J,r as v,j as h}from"./07VmgM2Z.js";function O(){const{$api:a}=k();function e({data:s}){return s}return a.interceptors.response.use(e),a}class R{constructor(e){o(this,"id");o(this,"name");o(this,"year");o(this,"description");o(this,"rating");o(this,"movieLength");o(this,"logo");o(this,"poster");o(this,"persons");o(this,"budget");o(this,"genres");var s,i;this.id=e.id,this.name=e.name,this.year=e.year,this.description=e.description,this.rating=e.rating?{kp:e.rating.kp,imdb:e.rating.imdb}:void 0,this.movieLength=e.movieLength,this.logo=(s=e.logo)==null?void 0:s.url,this.poster=(i=e.poster)==null?void 0:i.url,this.persons=e.persons,this.budget=e.budget,this.genres=e.genres?e.genres.map(u=>u.name).filter(u=>u!==void 0):void 0}}const F=J("movies",()=>{const s=v(),i=v(),u=v(1),m=v(),b=h(()=>!!i.value&&i.value.length>21&&i.value.length/21>u.value),L=h(()=>{if(!b.value||!i.value)return i.value;const n=u.value-1;return i.value.slice(n,21*u.value)}),w=h(()=>{var n,r;if((n=s.value)!=null&&n.items)return(r=s.value)==null?void 0:r.items.find(c=>c.id===m.value)});async function S(){try{const n=await O().get("movie",{params:{field:"rating.imdb",sortField:"votes.imdb",search:1,sortType:-1,limit:126},transformResponse(r){var t,l;const c=JSON.parse(r);return{items:(l=(t=c.docs)==null?void 0:t.map)==null?void 0:l.call(t,g=>{const p=new R(g);return JSON.parse(JSON.stringify(p))}),page:c.page,pages:c.pages,total:c.total}}});s.value=n,i.value=n==null?void 0:n.items,f()}catch(n){console.info(n)}}function P(n){var c;if(!((c=s.value)!=null&&c.items))return;if(!n){i.value=s.value.items;return}f();const r=n.toLowerCase();i.value=s.value.items.filter(t=>{var l,g,p,y;return t.name&&t.name.toLowerCase().includes(r)||t.genres&&t.genres.some(d=>d.toLowerCase()===r)||t.description&&t.description.toLowerCase().includes(r)||t.year&&t.year.toString().includes(r)||((l=t.rating)==null?void 0:l.imdb)&&t.rating.imdb.toString().includes(r)||((g=t.rating)==null?void 0:g.kp)&&t.rating.kp.toString().includes(r)||t.persons&&t.persons.some(d=>d.name&&d.name.toLowerCase().includes(r))||((p=t.budget)==null?void 0:p.value)&&t.budget.value.toString().includes(r)||((y=t.budget)==null?void 0:y.currency)&&t.budget.currency.toLowerCase().includes(r)})}function M(n){n&&(m.value=Number(n))}function C(){u.value+=1}function f(){u.value=1}return{topMovies:s,searchResults:i,moviesListWithPagination:L,canPaginate:b,getMovieById:w,movieId:m,getTopMovies:S,searchMovies:P,setMovieId:M,incrementPage:C,resetPage:f}});export{F as u};
